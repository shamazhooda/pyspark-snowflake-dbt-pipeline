-- CREATE ACCOUNTS
USE ROLE ACCOUNTADMIN;

-- Create a warehouse
CREATE WAREHOUSE IF NOT EXISTS PROJECT_WH WITH WAREHOUSE_SIZE = 'LARGE';

-- Create a database
CREATE DATABASE IF NOT EXISTS ANALYTICS;

-- Show grants on the warehouse
SHOW GRANTS ON WAREHOUSE PROJECT_WH;

-- Replace <USERNAME> with the actual username
GRANT ROLE SYSADMIN TO USER '<USERNAME>';  -- Use quotes if the username has special characters
GRANT USAGE ON WAREHOUSE PROJECT_WH TO ROLE SYSADMIN;
GRANT ALL ON DATABASE ANALYTICS TO ROLE SYSADMIN;

-- Switch to the newly created role
USE ROLE SYSADMIN;

-- Create a schema in the database
CREATE SCHEMA IF NOT EXISTS ANALYTICS.TRANSFORM_SCHEMA;
CREATE SCHEMA IF NOT EXISTS ANALYTICS.REPORT_SCHEMA;

-- Grant privileges on the schema to the role
GRANT USAGE ON SCHEMA ANALYTICS.TRANSFORM_SCHEMA TO ROLE SYSADMIN;
GRANT USAGE ON SCHEMA ANALYTICS.REPORT_SCHEMA TO ROLE SYSADMIN;
